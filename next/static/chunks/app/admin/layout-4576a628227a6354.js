(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[581],{373:(e,t,r)=>{"use strict";r.d(t,{JR:()=>o,eo:()=>a});let o="/api",a="https://diangraha-be-production.up.railway.app"},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var o=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,o.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:u,iconNode:d,...h}=e;return(0,o.createElement)("svg",{ref:t,...s,width:a,height:a,stroke:r,strokeWidth:i?24*Number(l)/Number(a):l,className:n("lucide",c),...!u&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"},...h},[...d.map(e=>{let[t,r]=e;return(0,o.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),i=(e,t)=>{let r=(0,o.forwardRef)((r,s)=>{let{className:i,...c}=r;return(0,o.createElement)(l,{ref:s,iconNode:t,className:n("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return r.displayName=a(e),r}},5229:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(1847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7036:(e,t,r)=>{Promise.resolve().then(r.bind(r,9387))},7621:(e,t,r)=>{"use strict";r.d(t,{R2:()=>s,dn:()=>n});var o=r(373);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r="".concat(o.JR).concat(e),a=localStorage.getItem("token"),n={...t,headers:{"Content-Type":"application/json",...a&&{Authorization:"Bearer ".concat(a)},...t.headers}},s=await fetch(r,n),l=await s.text(),i=null;if(l)try{i=JSON.parse(l)}catch(e){throw console.error("Invalid JSON response:",l),Error("Invalid JSON response")}if(!s.ok){if(401===s.status)throw localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",Error("Session expired");let e=(null==i?void 0:i.message)||"API Error: ".concat(s.status);throw Error(e)}return i}catch(e){throw e instanceof Error?e:Error("Network error")}}let n={fetchAchievements:async()=>{try{let e=await fetch("".concat(o.eo,"/api/achievements"),{method:"GET",headers:{accept:"*/*"}});if(!e.ok)throw Error("Failed to fetch achievements: ".concat(e.status));return await e.json()}catch(e){throw e instanceof Error?e:Error("Network error")}}},s={login:async e=>{try{let t=await fetch("".concat(o.eo,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.text(),a=null;if(r)try{a=JSON.parse(r)}catch(e){throw console.error("Invalid JSON from login API:",r),Error("Invalid JSON from login API")}if(!t.ok){let e=(null==a?void 0:a.message)||"Login failed: ".concat(t.status);throw Error(e)}return a}catch(e){throw e instanceof Error?e:Error("Network error")}},logout:async()=>a("/auth/logout",{method:"POST"})}},9387:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var o=r(5155),a=r(2115),n=r(9497),s=r(5229);function l(e){let{isOpen:t,onClose:r}=e;return((0,a.useEffect)(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),t)?(0,o.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white bg-opacity-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full mx-4 p-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Session Expired"}),(0,o.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,o.jsx)(s.A,{className:"w-5 h-5"})})]}),(0,o.jsx)("p",{className:"text-gray-600 mb-6",children:"Your session has expired due to inactivity. Please log in again to continue."}),(0,o.jsx)("div",{className:"flex justify-end",children:(0,o.jsx)("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Log In Again"})})]})}):null}function i(e){let{children:t}=e,{handleExpiration:r,isExpired:s,logout:i}=(0,n.A)();return(0,a.useEffect)(()=>{let e=()=>{r()},t=setInterval(e,3e4);return e(),()=>clearInterval(t)},[r]),(0,o.jsxs)(o.Fragment,{children:[t,(0,o.jsx)(l,{isOpen:s,onClose:i})]})}},9497:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var o=r(2115),a=r(7621);let n=()=>{let[e,t]=(0,o.useState)(!1),[r,n]=(0,o.useState)(null),[s,l]=(0,o.useState)(!1),i=()=>{let e=localStorage.getItem("token");if(!e)return!0;try{let t=JSON.parse(atob(e.split(".")[1])),r=1e3*t.exp;return Date.now()>r}catch(e){return!0}};return{login:async e=>{try{t(!0),n(null),l(!1);let r=await a.R2.login(e);return r.token&&(localStorage.setItem("token",r.token),localStorage.setItem("user",JSON.stringify(r))),r}catch(e){throw n(e instanceof Error?e.message:"Login failed"),e}finally{t(!1)}},logout:()=>{l(!1),localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"},isTokenExpired:i,handleExpiration:()=>{i()&&l(!0)},isExpired:s,loading:e,error:r}}}},e=>{e.O(0,[441,493,358],()=>e(e.s=7036)),_N_E=e.O()}]);