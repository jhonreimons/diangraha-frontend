(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[471],{1362:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},1786:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2056:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5500:(e,t,a)=>{Promise.resolve().then(a.bind(a,8054))},5626:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8054:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s=a(5155),l=a(2115),r=a(9497),n=a(4329),c=a(5820),o=a(5626),d=a(5229),i=a(1786),m=a(1362),h=a(2056),x=a(2619),u=a.n(x),g=a(63),p=a(373);function b(){let[e,t]=(0,l.useState)(null),[a,x]=(0,l.useState)(!0),[b,v]=(0,l.useState)({name:"",shortDesc:"",longDesc:""}),[y,f]=(0,l.useState)(null),[j,w]=(0,l.useState)(null),[N,S]=(0,l.useState)(null),[k,A]=(0,l.useState)(!1),[D,C]=(0,l.useState)(!1),[U,E]=(0,l.useState)(!1),{logout:I}=(0,r.A)(),O=(0,g.useSearchParams)().get("edit"),z=!!O,R=async e=>{try{var t,a,s,l;let r=await fetch("".concat(p.eo,"/api/services/").concat(e),{cache:"no-store"}),n=await r.json();v({name:null!=(a=n.name)?a:"",shortDesc:null!=(s=n.shortDesc)?s:"",longDesc:null!=(l=n.longDesc)?l:""}),S((null==(t=n.imageUrl)?void 0:t.startsWith("http"))?n.imageUrl:"".concat(p.eo).concat(n.imageUrl))}catch(e){console.error("Error fetching service:",e)}};(0,l.useEffect)(()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("user");if(!e){window.location.href="/login";return}a&&t(JSON.parse(a)),z&&O&&R(O)},[z,O]);let F=e=>{let{name:t,value:a}=e.target;"shortDesc"===t&&a.length>255||v(e=>({...e,[t]:a}))},M=async e=>{if(e.preventDefault(),!z&&!y)return void C(!0);E(!0);try{let e=localStorage.getItem("token"),t=z?"".concat(p.eo,"/api/services/").concat(O,"?name=").concat(encodeURIComponent(b.name),"&shortDesc=").concat(encodeURIComponent(b.shortDesc),"&longDesc=").concat(encodeURIComponent(b.longDesc)):"".concat(p.eo,"/api/services?name=").concat(encodeURIComponent(b.name),"&shortDesc=").concat(encodeURIComponent(b.shortDesc),"&longDesc=").concat(encodeURIComponent(b.longDesc)),a=new FormData;y?a.append("imageFile",y):a.append("imageFile",new Blob([]),"");let s=await fetch(t,{method:z?"PUT":"POST",headers:{Authorization:"Bearer ".concat(e)},body:a});if(!s.ok)throw Error("HTTP ".concat(s.status));A(!0)}catch(e){console.error("Error saving service:",e),alert("Failed to save service.")}finally{E(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-slate-100 flex flex-col md:flex-row",children:[(0,s.jsx)(n.A,{sidebarOpen:a,onToggle:x}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col ml-0 md:ml-[260px] transition-all duration-300",children:[(0,s.jsx)(c.A,{title:z?"Edit Service":"Add New Service",user:e,onLogout:()=>I(),sidebarOpen:a,onToggle:x}),(0,s.jsxs)("main",{className:"flex-1 bg-gray-50 min-h-screen pt-[100px] px-4 md:px-8",children:[(0,s.jsxs)("div",{className:"max-w-3xl mx-auto bg-white rounded-2xl shadow-md p-6 md:p-8 mt-4",children:[(0,s.jsxs)(u(),{href:"/admin/services",className:"inline-flex items-center text-blue-600 hover:text-blue-800 transition",children:[(0,s.jsx)(o.A,{className:"w-4 h-4 mr-2"})," Back to Service Management"]}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 my-6",children:z?"Edit Service":"Add New Service"}),(0,s.jsxs)("form",{onSubmit:M,className:"space-y-6",children:[(0,s.jsx)("input",{type:"text",name:"name",required:!0,value:b.name,onChange:F,placeholder:"Enter service name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-gray-900 placeholder:text-gray-500"}),(0,s.jsx)("textarea",{name:"shortDesc",rows:3,maxLength:255,value:b.shortDesc,onChange:F,placeholder:"Short description",className:"w-full px-4 py-2 border border-gray-300 rounded-lg resize-none text-gray-900 placeholder:text-gray-500"}),(0,s.jsx)("textarea",{name:"longDesc",rows:6,value:b.longDesc,onChange:F,placeholder:"Full description",className:"w-full px-4 py-2 border border-gray-300 rounded-lg resize-none text-gray-900 placeholder:text-gray-500"}),(0,s.jsxs)("div",{className:"relative border-2 border-dashed p-6 rounded-xl bg-gray-50 text-center hover:border-blue-400",children:[j||N?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:j||N||"",className:"mx-auto max-h-48 rounded-lg shadow-sm object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>{f(null),w(null)},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1",children:(0,s.jsx)(d.A,{className:"w-4 h-4"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Click to upload"})]}),(0,s.jsx)("input",{type:"file",accept:"image/*",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&(f(a),w(URL.createObjectURL(a)),S(null))}})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-6",children:[(0,s.jsx)(u(),{href:"/admin/services",className:"px-5 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:U,className:"px-5 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 hover:scale-105 disabled:opacity-50",children:U?z?"Updating...":"Adding...":z?"Update Service":"Add Service"})]})]})]}),k&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black/60 z-[9999]",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full text-center",children:[(0,s.jsx)(m.A,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:z?"Service Updated!":"Service Added!"}),(0,s.jsx)("button",{onClick:()=>{A(!1),window.location.href="/admin/services"},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mt-4",children:"OK"})]})}),D&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black/60 z-[9999]",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full text-center",children:[(0,s.jsx)(h.A,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Image is required"}),(0,s.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mt-4",children:"OK"})]})})]})]})]})}function v(){return(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)("div",{className:"p-10 text-center",children:"Loading form..."}),children:(0,s.jsx)(b,{})})}}},e=>{e.O(0,[619,25,730,441,493,358],()=>e(e.s=5500)),_N_E=e.O()}]);