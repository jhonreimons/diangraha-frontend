(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2529:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5626:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6872:(e,t,s)=>{Promise.resolve().then(s.bind(s,9896))},9896:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(5155),r=s(2115),l=s(63),i=s(373),n=s(9497),o=s(5820),c=s(4329),d=s(2529),x=s(5626),m=s(1847);let h=(0,m.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),u=(0,m.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var g=s(2619),p=s.n(g);function b(){let e=(0,l.useRouter)(),t=(0,l.useParams)(),s=(0,l.useSearchParams)(),{id:m}=t,g=s.get("edit"),b=s.get("subServiceId"),[f,y]=(0,r.useState)(!1),[w,v]=(0,r.useState)(!1),[k,j]=(0,r.useState)(!1),[N,S]=(0,r.useState)(""),[A,E]=(0,r.useState)(null),[W,z]=(0,r.useState)(!1),[O,C]=(0,r.useState)(null),{logout:P}=(0,n.A)();(0,r.useEffect)(()=>{let t=localStorage.getItem("token"),s=localStorage.getItem("user");if(!t)return void e.push("/login");s&&E(JSON.parse(s)),g&&(j(!0),F(g))},[g]);let F=async e=>{try{v(!0);let t=localStorage.getItem("token"),s=await fetch("".concat(i.eo,"/api/services/sub-services/works/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw Error("Failed to fetch work detail");let a=await s.json();S(a.description||""),C(null)}catch(e){console.error("Error fetching work detail:",e),C("Failed to fetch work detail. Please try again.")}finally{v(!1)}},M=async e=>{if(e.preventDefault(),N.trim())try{v(!0);let e=localStorage.getItem("token"),t=k?"".concat(i.eo,"/api/services/sub-services/").concat(b,"/works/").concat(g):"".concat(i.eo,"/api/services/sub-services/").concat(b,"/works");if(!(await fetch(t,{method:k?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({description:N})})).ok)throw Error("Failed to save work");z(!0)}catch(e){console.error("Error saving work:",e),C("Failed to save work. Please try again.")}finally{v(!1)}};return((0,r.useEffect)(()=>{let e=()=>y(window.innerWidth>=1024);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),A)?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-100 flex flex-col md:flex-row",children:[(0,a.jsx)(c.A,{sidebarOpen:f,onToggle:y}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col transition-all duration-300",children:[(0,a.jsx)(o.A,{title:k?"Edit Work":"Add Work",user:A,onLogout:P,sidebarOpen:f,onToggle:y}),(0,a.jsx)("main",{className:"flex-1 transition-all duration-300 mt-[80px] px-4 sm:px-6 md:px-10 py-8 ".concat(f?"md:ml-72":"md:ml-24"),children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto bg-white shadow-md rounded-xl p-6 md:p-10 border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl md:text-2xl font-bold text-gray-900",children:k?"Edit Work":"Add New Work"}),(0,a.jsxs)(p(),{href:"/admin/services",className:"flex items-center text-gray-600 hover:text-blue-600 text-sm",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-1"})," Back"]})]}),O&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-2 rounded-lg mb-4 text-sm",children:O}),(0,a.jsxs)("form",{onSubmit:M,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Work Description ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{value:N,onChange:e=>S(e.target.value),placeholder:"Enter description of this work",rows:5,className:" w-full border border-gray-300 rounded-lg p-3 text-sm text-gray-800 bg-white focus:ring-2 focus:ring-blue-500 focus:outline-none placeholder-gray-500 resize-none selection:bg-blue-100 selection:text-gray-900 ",required:!0})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>e.push("/admin/services"),className:"px-4 py-2 text-gray-600 border rounded-lg hover:bg-gray-100 transition",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:w,className:"bg-blue-600 text-white px-5 py-2.5 rounded-lg shadow hover:bg-blue-700 flex items-center transition",children:w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{className:"w-4 h-4 mr-2"}),k?"Update Work":"Save Work"]})})]})]})]})})]}),W&&(0,a.jsx)(()=>(0,a.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg w-[90%] max-w-sm p-6 text-center transition-all duration-200",children:[(0,a.jsx)("div",{className:"flex justify-center mb-3",children:(0,a.jsx)(d.A,{className:"text-green-500 w-12 h-12"})}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:k?"Work Updated!":"Work Added!"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-5",children:['Work "',N,'" ',k?"updated":"added"," successfully."]}),(0,a.jsx)("button",{onClick:()=>e.push("/admin/services"),className:"bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 shadow",children:"OK"})]})}),{})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Loading user..."})}}},e=>{e.O(0,[619,25,730,441,493,358],()=>e(e.s=6872)),_N_E=e.O()}]);